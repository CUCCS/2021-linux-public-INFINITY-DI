# 实验报告三：开机自启动项管理

## 实验环境
*  Virtualbox
*  Ubuntu 20.04 Server 64bit
*  Microsoft Windows10 版本20H2(操作系统内部版本19042.928)

---
## 实验步骤
* 在asciinema注册一个账号，并根据官方提供的指令在本地安装配置好asciinema
* 确保本地已经完成asciinema auth，并在asciinema成功关联了本地账号和在线账号
* 在命令行中远程连接虚拟机并进行相应操作
### 一、Systemd入门教程--命令篇
* 三.系统管理
[![asciicast](https://asciinema.org/a/407982.svg)](https://asciinema.org/a/407982)
* 四.Unit
[![asciicast](https://asciinema.org/a/407997.svg)](https://asciinema.org/a/407997)
* 五.Unit 配置文件
[![asciicast](https://asciinema.org/a/407999.svg)](https://asciinema.org/a/407999)
* 六.Target
[![asciicast](https://asciinema.org/a/408000.svg)](https://asciinema.org/a/408000)
* 七.日志管理
[![asciicast](https://asciinema.org/a/408002.svg)](https://asciinema.org/a/408002)
### 二.Systemd入门教程--实战篇
* 开机启动
* 启动服务
* 停止服务
* 读懂配置文件
* Unit区块：启动顺序与依赖关系
* Service区块：启动行为
* Install区块
* Target的配置文件
* 修改配置文件后重启
[![asciicast](https://asciinema.org/a/408240.svg)](https://asciinema.org/a/408240)


***

## 自查清单

* 如何添加一个用户并使其具备sudo执行程序的权限？
```bash
adduser username #添加用户名
username ALL=(ALL) ALL #此句为添加sudo权限语句
adduser <username> <username> ALL=(ALL) ALL
```
* 如何将一个用户添加到一个用户组？
```bash
usermod -a -G <groupname> <username>
```
* 如何查看当前系统的分区表和文件系统详细信息？
```bash
sudo fdisk -l #查看分区表
df -h #查看磁盘占用的空间
df -T #查看挂载的文件系统类型
```
* 如何实现开机自动挂载Virtualbox的共享目录分区？
```bash
sudo mkdir /mnt/share sudo mount -t vboxsf gongxiang/mnt/share
```
* 基于LVM（逻辑分卷管理）的分区如何实现动态扩容和缩减容量？
```bash
lvextend -L + <容量> <PATH> #动态扩容

lvreduce -L - <容量> <PATH> #缩减容量
```
* 如何通过systemd设置实现在网络连通时运行一个指定脚本，在网络断开时运行另一个脚本？
```bash 
ExecStartPost=<路径1> post1  #设置启动服务之后执行的命令
ExecStopPost=<路径2> post2  #设置停止服务之后执行的命令
sudo systemctl daemon-reload #重载
sudo systemctl restart httpd.service # 重启 
```

* 如何通过systemd设置实现一个脚本在任何情况下被杀死之后会立即重新启动？实现杀不死？
```bash
[Service] Restart=always #[service]区块中设置
sudo systemctl start [进程名] #重载配置文件
```
## 参考资料
* http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html
* http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-part-two.html